# AlphaTrader Pro – Implementation Plan

## Phase Status Overview
- **Phase 1 – Schema & configuration** (Complete): Redis key helpers now expose dedicated namespaces for dealer-flow metrics, flow clusters, and VIX1D data, while `config/config.yaml` surfaces cadence, TTL, and weighting controls for the new analytics pipeline.【F:src/redis_keys.py†L37-L141】【F:config/config.yaml†L84-L208】
- **Phase 2 – Dealer-flow analytics** (Complete): DealerFlowCalculator derives Vanna, Charm, skew, and hedging elasticity from the normalized option chain and persists rolling histories that the analytics engine aggregates into symbol, sector, and portfolio snapshots.【F:src/dealer_flow_calculator.py†L52-L206】【F:src/analytics_engine.py†L73-L220】【F:src/analytics_engine.py†L500-L660】
- **Phase 3 – Flow clustering & volatility regimes** (Complete): FlowClusterModel classifies recent trade prints into participant archetypes while VolatilityMetrics maintains VIX1D history and regime tags, both orchestrated by the analytics scheduler and folded into downstream aggregates.【F:src/flow_clustering.py†L30-L199】【F:src/volatility_metrics.py†L19-L190】【F:src/analytics_engine.py†L500-L660】
- **Phase 4 – Signal integration & scoring** (Complete): The default feature reader and DTE playbooks ingest dealer-flow, clustering, and VIX1D features and rebalance confidence scoring weights so emissions align with the new analytics payloads.【F:src/signal_generator.py†L542-L797】【F:src/dte_strategies.py†L68-L209】【F:src/dte_strategies.py†L391-L540】【F:config/config.yaml†L143-L208】
- **Phase 5 – Backfills, monitoring, and regression coverage** (Pending): Historical backfill utilities, dedicated monitoring dashboards for the new metrics, and regression tests for dealer-flow components remain open items.

## Phase 1 – Schema & Configuration
The Redis schema now dedicates stable helpers for dealer-flow buckets (`analytics:vanna`, `analytics:charm`, `analytics:hedging`, `analytics:skew`), flow-cluster payloads, and VIX1D volatility state to keep all producers and consumers aligned on key formats.【F:src/redis_keys.py†L37-L141】 Configuration exposes cadence, TTLs, and weighting knobs for each analytics family—including cluster windows, VIX1D thresholds, and dealer-flow history depth—allowing operators to retune behaviour without code changes.【F:config/config.yaml†L84-L141】 These settings are loaded during bootstrap alongside existing module toggles so every service shares a single source of truth.【F:main.py†L100-L176】

## Phase 2 – Dealer-Flow Analytics
`DealerFlowCalculator` walks the normalized options chain, filters liquid near-dated contracts, and computes per-contract Greeks before aggregating Vanna, Charm, 0DTE skew, and hedging elasticity into Redis payloads with rolling history/z-score stats that downstream consumers can query.【F:src/dealer_flow_calculator.py†L75-L206】 The analytics engine schedules the calculator on a configurable cadence, writing results into symbol snapshots and portfolio/sector rollups so execution, monitoring, and research services share the same dealer-flow view without recomputing histories.【F:src/analytics_engine.py†L73-L220】【F:src/analytics_engine.py†L500-L660】

## Phase 3 – Flow Clustering & Volatility Regimes
`FlowClusterModel` ingests the latest trade prints, assembles feature vectors (size, direction, sweep velocity, notional, gap), and runs a three-cluster KMeans to infer participant and strategy distributions before persisting them to Redis.【F:src/flow_clustering.py†L30-L199】 `VolatilityMetrics` fetches VIX1D from Yahoo Finance, maintains a time-decayed history, and classifies the current regime based on level, z-score, and short-term changes; results are cached with TTLs and exposed through the shared schema.【F:src/volatility_metrics.py†L19-L190】 AnalyticsEngine triggers both calculators through its interval map and drops the outputs directly into the symbol snapshots consumed by portfolio and sector aggregations.【F:src/analytics_engine.py†L500-L660】

## Phase 4 – Signal Integration & Scoring
The default feature reader now batches Redis fetches for dealer-flow, hedging, skew, flow-cluster, and VIX1D keys, normalizing each payload and attaching them to the feature map consumed by the strategies.【F:src/signal_generator.py†L542-L797】 The 0DTE/1DTE playbooks incorporate the new metrics into their confidence gates—e.g., requiring minimum Vanna/Charm balance, flow-momentum thresholds, and volatility regime alignment before emitting—while their weighting tables live in configuration for quick tuning.【F:src/dte_strategies.py†L391-L540】【F:config/config.yaml†L143-L208】 Signals therefore reflect the broader dealer and volatility backdrop instead of relying solely on VPIN and GEX.

## Phase 5 – Outstanding Follow-Ups
- Add historical backfill jobs for dealer-flow, flow clusters, and VIX1D so ingestors can reconstruct state after outages.
- Build monitoring/backtesting notebooks or dashboards focused on the new metrics (success rates, z-score drift, cluster stability).
- Extend automated regression coverage to exercise DealerFlowCalculator edge cases and signal-scoring paths that combine the new features.

## Operational Orchestration
`main.py` validates the environment, connects to Redis, and instantiates the analytics engine alongside ingestion, parameter discovery, and optional signal/execution stacks. During startup it schedules the analytics engine asynchronously so DealerFlowCalculator, FlowClusterModel, and VolatilityMetrics run continuously without blocking other services.【F:main.py†L111-L326】 Health monitoring keeps the analytics heartbeat fresh in Redis, ensuring operator dashboards can confirm the new calculators are live.【F:main.py†L327-L438】
